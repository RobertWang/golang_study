# Go æ¯æ—¥ä¸€é¢˜

> ä»Šæ—¥ï¼ˆ2023-07-15ï¼‰çš„é¢˜ç›®å¦‚ä¸‹

ä¸‹é¢ä»£ç è¾“å‡ºä»€ä¹ˆï¼Ÿ

```golang
type Person struct {
	age int
}

func main() {
	person := &Person{28}

	// 1.
	defer fmt.Println(person.age)

	// 2.
	defer func(p *Person) {
		fmt.Println(p.age)
	}(person)

	// 3.
	defer func() {
		fmt.Println(person.age)
	}()

	person = &Person{29}
}
```

åŒ [2023-07-13](../13/README.md) çš„é¢˜ç›®

<details>
<summary style="cursor: pointer">ğŸ”‘ ç­”æ¡ˆè§£æï¼š</summary>
<div>

å‚è€ƒç­”æ¡ˆåŠè§£æï¼š29 28 28ã€‚

è¿™é“é¢˜ä¹‹å‰é¢˜ç›®çš„åŸºç¡€ä¸Šåšäº†ä¸€ç‚¹ç‚¹å°æ”¹åŠ¨ï¼Œå‰ä¸€é¢˜æœ€åä¸€è¡Œä»£ç  `person.age = 29` æ˜¯ä¿®æ”¹å¼•ç”¨å¯¹è±¡çš„æˆå‘˜ ageï¼Œè¿™é¢˜æœ€åä¸€è¡Œä»£ç  `person = &Person{29}` æ˜¯ä¿®æ”¹å¼•ç”¨å¯¹è±¡æœ¬èº«ï¼Œæ¥çœ‹çœ‹æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚

1. person.age è¿™ä¸€è¡Œä»£ç è·Ÿä¹‹å‰å«ä¹‰æ˜¯ä¸€æ ·çš„ï¼Œæ­¤æ—¶æ˜¯å°† 28 å½“åš defer å‡½æ•°çš„å‚æ•°ï¼Œä¼šæŠŠ 28 ç¼“å­˜åœ¨æ ˆä¸­ï¼Œç­‰åˆ°æœ€åæ‰§è¡Œè¯¥ defer è¯­å¥çš„æ—¶å€™å–å‡ºï¼Œå³è¾“å‡º 28ï¼›
2. defer ç¼“å­˜çš„æ˜¯ç»“æ„ä½“ Person{28} çš„åœ°å€ï¼Œè¿™ä¸ªåœ°å€æŒ‡å‘çš„ç»“æ„ä½“æ²¡æœ‰è¢«æ”¹å˜ï¼Œæœ€å defer è¯­å¥åé¢çš„å‡½æ•°æ‰§è¡Œçš„æ—¶å€™å–å‡ºä»æ˜¯ 28ï¼›
3. é—­åŒ…å¼•ç”¨ï¼Œperson çš„å€¼å·²ç»è¢«æ”¹å˜ï¼ŒæŒ‡å‘ç»“æ„ä½“ `Person{29}`ï¼Œæ‰€ä»¥è¾“å‡º 29.

ç”±äº defer çš„æ‰§è¡Œé¡ºåºä¸ºå…ˆè¿›åå‡ºï¼Œå³ 3 2 1ï¼Œæ‰€ä»¥è¾“å‡º 29 28 28ã€‚

</div>
</details>
