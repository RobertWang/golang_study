# Go æ¯æ—¥ä¸€é¢˜

> ä»Šæ—¥ï¼ˆ2023-09-03ï¼‰çš„é¢˜ç›®å¦‚ä¸‹

Go101 ä½œè€…å‘å¸ƒäº†ä¸€é“æœ‰æ„æ€çš„é¢˜ç›®ï¼Œè¿™é“é¢˜ä¸»è¦è€ƒå¯Ÿç»†èŠ‚ç‚¹ï¼ŒGo101 è¿™æœ¬ä¹¦ä¹Ÿæ˜¯ä»¥æŠ ç»†èŠ‚è‘—ç§°ã€‚çœ‹çœ‹è¿™é“é¢˜ï¼Œä»¥ä¸‹ç¨‹åºè¾“å‡ºä»€ä¹ˆï¼Ÿï¼ˆå•é€‰ï¼‰

```golang
package main

const s = "Go101.org"

// len(s) == 9
// 1 << 9 == 512
// 512 / 128 == 4

var a byte = 1 << len(s) / 128
var b byte = 1 << len(s[:]) / 128

func main() {
	println(a, b)
}
```

- Aã€0 0ï¼›
- Bã€0 4ï¼›
- Cï¼š4 0ï¼›
- Dï¼š4 4

è¿™é‡Œæ¶‰åŠåˆ°ä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼Œåœ¨ Go è¯­è¨€è§„èŒƒä¸­éƒ½æœ‰æ˜ç¡®çš„è¯´æ˜ï¼Œä½†ç¡®å®å¾ˆç»†èŠ‚ã€‚ä½ ç­”å¯¹äº†å—ï¼ŸåŸå› çŸ¥æ™“å—ï¼Ÿ

<details>
<summary style="cursor: pointer">ğŸ”‘ ç­”æ¡ˆè§£æï¼š</summary>
<div>

ç­”æ¡ˆæ˜¯ 4 0ï¼ˆå³é€‰ Cï¼‰ã€‚

ä¸å°‘äººå¯¹è¿™ä¸ªç»“æœåº”è¯¥å¾ˆåƒæƒŠï¼Œå› ä¸ºä»ç­”é¢˜ç»“æœçœ‹ï¼Œä¸åˆ°ä¸€åŠçš„äººç­”å¯¹äº†ã€‚è€Œä¸”ï¼Œå¦‚æœåªç»™ `var b byte = 1 << len(s[:]) / 128`ï¼Œæ²¡æœ‰ a å¯¹æ¯”ï¼Œæˆ‘æƒ³ç­”å¯¹çš„äººä¼šæ›´å°‘ã€‚å› ä¸ºæœ‰å¯¹æ¯”ï¼Œå¾ˆå¤šäººè™½ç„¶ç›´è§‰æ˜¯ 4 4ï¼Œä½†æƒ³åˆ°ä¸€å®šæœ‰é™·é˜±ï¼Œæ‰€ä»¥ä¼šé‡æ–°æ€è€ƒã€‚

å¥½å‡ ä¸ªç¾¤éƒ½é—®ï¼Œä¸ºä»€ä¹ˆç»“æœä¼šæ˜¯ 4 0ï¼Œå¸Œæœ›æˆ‘è§£é‡Šä¸‹ã€‚å› æ­¤æœ‰äº†æ­¤æ–‡ã€‚

è¿™ä¸ªå°é¢˜æ¶‰åŠåˆ°å‡ ä¸ªçŸ¥è¯†ç‚¹ã€‚

### len å‡½æ•°çš„ç»“æœ

è¦æ³¨æ„ï¼Œlen æ˜¯ä¸€ä¸ªå†…ç½®å‡½æ•°ã€‚åœ¨å®˜æ–¹æ ‡å‡†åº“æ–‡æ¡£ [å…³äº len å‡½æ•°](https://docs.studygolang.com/pkg/builtin/#len) æœ‰è¿™ä¹ˆä¸€å¥ï¼š

> For some arguments, such as a string literal or a simple array expression, the result can be a constant. See the Go language specificationâ€™s â€œLength and capacityâ€ section for details.

> å¯¹äºæŸäº›å‚æ•°ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²å­—é¢é‡æˆ–ç®€å•çš„æ•°ç»„è¡¨è¾¾å¼ï¼Œå…¶ç»“æœå¯ä»¥æ˜¯ä¸€ä¸ªå¸¸é‡ã€‚è¯¦ç»†å†…å®¹è¯·å‚é˜… Go è¯­è¨€è§„èŒƒä¸­çš„â€œé•¿åº¦å’Œå®¹é‡â€éƒ¨åˆ†ã€‚

æ˜ç¡®æ”¯æŒï¼Œå½“å‚æ•°æ˜¯å­—ç¬¦ä¸²å­—é¢é‡å’Œç®€å• array è¡¨è¾¾å¼ï¼Œlen å‡½æ•°è¿”å›å€¼æ˜¯å¸¸é‡ï¼Œè¿™å¾ˆé‡è¦ã€‚

ä¸Šé¢˜ä¸­ï¼Œå¦‚æœ `const s = "Go101.orgâ€` æ”¹ä¸º `var s = "Go101.org"` ç»“æœåˆä¼šæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ

```golang
package main

var s = "Go101.org"

var a byte = 1 << len(s) / 128
var b byte = 1 << len(s[:]) / 128

func main() {
	println(a, b)
}
```

ç»“æœæ˜¯ 0 0ã€‚

ä½†æ”¹ä¸ºè¿™æ ·ï¼š

```golang
package main

var s = [9]byte{'G', 'o', '1', '0', '1', '.', 'o', 'r', 'g'}

var a byte = 1 << len(s) / 128
var b byte = 1 << len(s[:]) / 128

func main() {
	println(a, b)
}
```

ç»“æœåˆæ˜¯ 4 0ã€‚

æ¥ç€çœ‹æ–‡æ¡£é‚£å¥è¯çš„ååŠå¥ï¼ŒæŸ¥çœ‹ Go è¯­è¨€è§„èŒƒä¸­ [å…³äºé•¿åº¦å’Œå®¹é‡çš„è¯´æ˜](https://hao.studygolang.com/golang_spec.html#id221) ã€‚

> å†…ç½®å‡½æ•° len å’Œ cap è·å–å„ç§ç±»å‹çš„å®å‚å¹¶è¿”å›ä¸€ä¸ª int ç±»å‹ç»“æœã€‚å®ç°ä¼šä¿è¯ç»“æœæ€»æ˜¯ä¸€ä¸ª int å€¼ã€‚
>
> å¦‚æœ s æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡ï¼Œé‚£ä¹ˆ len(s) æ˜¯ä¸€ä¸ªå¸¸é‡ ã€‚å¦‚æœ s ç±»å‹æ˜¯ä¸€ä¸ªæ•°ç»„æˆ–åˆ°æ•°ç»„çš„æŒ‡é’ˆä¸”è¡¨è¾¾å¼ s ä¸åŒ…å« ä¿¡é“æ¥æ”¶ æˆ–ï¼ˆéå¸¸é‡çš„ï¼‰ å‡½æ•°è°ƒç”¨çš„è¯ï¼Œ é‚£ä¹ˆè¡¨è¾¾å¼ len(s) å’Œ cap(s) æ˜¯å¸¸é‡ï¼›è¿™ç§æƒ…å†µä¸‹ï¼Œ s æ˜¯ä¸æ±‚å€¼çš„ã€‚å¦åˆ™çš„è¯ï¼Œ len å’Œ cap çš„è°ƒç”¨ç»“æœä¸æ˜¯å¸¸é‡ä¸” s ä¼šè¢«æ±‚å€¼ã€‚

å¯è§é¢˜ç›®ä¸­ï¼š

```golang
var a byte = 1 << len(s) / 128
var b byte = 1 << len(s[:]) / 128
```

ç¬¬ä¸€å¥çš„ len(s) æ˜¯å¸¸é‡ï¼ˆå› ä¸º s æ˜¯å­—ç¬¦ä¸²å¸¸é‡ï¼‰ï¼›è€Œç¬¬äºŒå¥çš„ len(s[:]) ä¸æ˜¯å¸¸é‡ã€‚è¿™æ˜¯è¿™ä¸¤æ¡è¯­å¥çš„å”¯ä¸€åŒºåˆ«ï¼šä¸¤ä¸ª len çš„è¿”å›ç»“æœæ•°å€¼å¹¶æ— å·®å¼‚ï¼Œéƒ½æ˜¯ 9ï¼Œä½†ä¸€ä¸ªæ˜¯å¸¸é‡ä¸€ä¸ªä¸æ˜¯ã€‚

### å…³äºä½ç§»æ“ä½œ

æ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œç°åœ¨é—®é¢˜çš„å…³é”®åœ¨äºä½ç§»è¿ç®—è¿™é‡Œã€‚Go è¯­è¨€è§„èŒƒä¸­æœ‰[è¿™ä¹ˆä¸€å¥](https://docs.studygolang.com/ref/spec#Operators) ï¼š

> The right operand in a shift expression must have integer type or be an untyped constant representable by a value of type uint. If the left operand of a non-constant shift expression is an untyped constant, it is first implicitly converted to the type it would assume if the shift expression were replaced by its left operand alone.

å¤§æ„æ˜¯ï¼šåœ¨ä½ç§»è¡¨è¾¾å¼çš„å³ä¾§çš„æ“ä½œæ•°å¿…é¡»ä¸ºæ•´æ•°ç±»å‹ï¼Œæˆ–è€…å¯ä»¥è¢« uint ç±»å‹çš„å€¼æ‰€è¡¨ç¤ºçš„æ— ç±»å‹çš„å¸¸é‡ã€‚å¦‚æœä¸€ä¸ªéå¸¸é‡ä½ç§»è¡¨è¾¾å¼çš„å·¦ä¾§çš„æ“ä½œæ•°æ˜¯ä¸€ä¸ªæ— ç±»å‹å¸¸é‡ï¼Œé‚£ä¹ˆå®ƒä¼šå…ˆè¢«éšå¼åœ°è½¬æ¢ä¸ºå‡å¦‚ä½ç§»è¡¨è¾¾å¼è¢«å…¶å·¦ä¾§æ“ä½œæ•°å•ç‹¬æ›¿æ¢åçš„ç±»å‹ã€‚

è¿™é‡Œçš„å…³é”®åœ¨äºå¸¸é‡ä½ç§»è¡¨è¾¾å¼ã€‚æ ¹æ®ä¸Šæ–‡çš„åˆ†æï¼Œ`1 << len(s)` æ˜¯å¸¸é‡ä½ç§»è¡¨è¾¾å¼ï¼Œè€Œ `1 << len(s[:])` ä¸æ˜¯ã€‚

è§„èŒƒä¸Šå…³äºå¸¸é‡è¡¨è¾¾å¼ä¸­ï¼Œè¿˜æœ‰ [è¿™ä¹ˆä¸€å¥](https://docs.studygolang.com/ref/spec#Constant_expressions) ï¼š

> If the left operand of a constant shift expression is an untyped constant, the result is an integer constant; otherwise it is a constant of the same type as the left operand, which must be of integer type.

å¤§æ„æ˜¯ï¼šå¦‚æœå¸¸é‡ ä½ç§»è¡¨è¾¾å¼ çš„å·¦ä¾§æ“ä½œæ•°æ˜¯ä¸€ä¸ªæ— ç±»å‹å¸¸é‡ï¼Œé‚£ä¹ˆå…¶ç»“æœæ˜¯ä¸€ä¸ªæ•´æ•°å¸¸é‡ï¼›å¦åˆ™å°±æ˜¯å’Œå·¦ä¾§æ“ä½œæ•°åŒä¸€ç±»å‹çš„å¸¸é‡ï¼ˆå¿…é¡»æ˜¯ æ•´æ•°ç±»å‹ ï¼‰

å› æ­¤å¯¹äº `var a byte = 1 << len(s) / 128`ï¼Œå› ä¸º `1 << len(s)` æ˜¯ä¸€ä¸ªå¸¸é‡ä½ç§»è¡¨è¾¾å¼ï¼Œå› æ­¤å®ƒçš„ç»“æœä¹Ÿæ˜¯ä¸€ä¸ªæ•´æ•°å¸¸é‡ï¼Œæ‰€ä»¥æ˜¯ 512ï¼Œæœ€åé™¤ä»¥ 128ï¼Œæœ€ç»ˆç»“æœå°±æ˜¯ 4ã€‚

è€Œå¯¹äº `var b byte = 1 << len(s[:]) / 128`ï¼Œå› ä¸º `1 << len(s[:])` ä¸æ˜¯ä¸€ä¸ªå¸¸é‡ä½ç§»è¡¨è¾¾å¼ï¼Œè€Œåšæ“ä½œæ•°æ˜¯ 1ï¼Œä¸€ä¸ªæ— ç±»å‹å¸¸é‡ï¼Œæ ¹æ®è§„èŒƒå®šä¹‰å®ƒæ˜¯ byte ç±»å‹ï¼ˆæ ¹æ®ï¼šå¦‚æœä¸€ä¸ªéå¸¸é‡ä½ç§»è¡¨è¾¾å¼çš„å·¦ä¾§çš„æ“ä½œæ•°æ˜¯ä¸€ä¸ªæ— ç±»å‹å¸¸é‡ï¼Œé‚£ä¹ˆå®ƒä¼šå…ˆè¢«éšå¼åœ°è½¬æ¢ä¸ºå‡å¦‚ä½ç§»è¡¨è¾¾å¼è¢«å…¶å·¦ä¾§æ“ä½œæ•°å•ç‹¬æ›¿æ¢åçš„ç±»å‹ï¼‰ã€‚

ä¸ºä»€ä¹ˆæ˜¯ byte ç±»å‹ï¼Œå¤§å®¶å¯èƒ½è¿˜æ˜¯æœ‰ç‚¹æ™•ã€‚è¿™è¦å›åˆ°å…³äºå¸¸é‡çš„è¯´æ˜ä¸Šã€‚

### å¸¸é‡

å¸¸é‡æ˜¯åœ¨ç¼–è¯‘çš„æ—¶å€™è¿›è¡Œè®¡ç®—çš„ã€‚åœ¨ Go è¯­è¨€ä¸­ï¼Œå¸¸é‡åˆ†ä¸¤ç§ï¼šæ— ç±»å‹å’Œæœ‰ç±»å‹ã€‚Go è§„èŒƒä¸Šè¯´ï¼Œå­—é¢å€¼å¸¸é‡ï¼Œ true , false , iota ä»¥åŠä¸€äº›ä»…åŒ…å«æ— ç±»å‹çš„æ’å®šæ“ä½œæ•°çš„ å¸¸é‡è¡¨è¾¾å¼ æ˜¯æ— ç±»å‹çš„ã€‚

é‚£æœ‰ç±»å‹å¸¸é‡æ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿä¸€èˆ¬æœ‰ä¸¤ç§ï¼šæ˜¾ç¤ºå£°æ˜æˆ–éšå¼å¾—åˆ°ã€‚æ¯”å¦‚ï¼š

```golang
const a int32 = 23
const b float32 = 0.1
```

æ— ç±»å‹å¸¸é‡éƒ½æœ‰ä¸€ä¸ªé»˜è®¤ç±»å‹ï¼ˆæ— ç±»å‹å¸¸é‡çš„é»˜è®¤ç±»å‹åˆ†åˆ«æ˜¯ bool , rune , int , float64 , complex128 æˆ– stringï¼‰ã€‚å½“åœ¨ä¸Šä¸‹æ–‡ä¸­éœ€è¦è¯·æ±‚è¯¥å¸¸é‡ä¸ºä¸€ä¸ªå¸¦ç±»å‹çš„å€¼æ—¶ï¼Œè¿™ä¸ª é»˜è®¤ç±»å‹ ä¾¿æŒ‡å‘è¯¥å¸¸é‡éšå¼è½¬æ¢åçš„ç±»å‹ã€‚

æ‰€ä»¥ `var b byte = 1 << len(s[:]) / 128` ä¸­ï¼Œæ ¹æ®è§„èŒƒå®šä¹‰ï¼Œ1 ä¼šéšå¼è½¬æ¢ä¸º byte ç±»å‹ï¼Œå› æ­¤ `1 << len(s[:])` çš„ç»“æœä¹Ÿæ˜¯ byte ç±»å‹ï¼Œè€Œ byte ç±»å‹æœ€å¤§åªèƒ½è¡¨ç¤º 255ï¼Œå¾ˆæ˜¾ç„¶ 512 æº¢å‡ºäº†ï¼Œç»“æœä¸º 0ï¼Œå› æ­¤æœ€å b çš„ç»“æœä¹Ÿæ˜¯ 0ã€‚

å°ç»“
ä¸€é“å¾ˆå…·è¿·æƒ‘æ€§çš„é¢˜ç›®å¼•å‡ºè¿™ä¹ˆå¤šå°çŸ¥è¯†ç‚¹ã€‚å¯èƒ½æœ‰äººè¦å–·ï¼šè®¨è®ºè¿™äº›æœ‰ä»€ä¹ˆç”¨ï¼Ÿè¿™ä¹Ÿå¤ªç»†èŠ‚äº†ã€‚æˆ‘æƒ³è¯´çš„æ˜¯ï¼ŒGo è¯­è¨€è§„èŒƒï¼Œç»†èŠ‚ç‚¹å¾ˆå¤šï¼Œèƒ½å¤šæŒæ¡ä¸€äº›æ²¡åå¤„ï¼Œè¯´ä¸å®šå°†æ¥å®é™…å·¥ä½œå°±é‡åˆ°äº†ç±»ä¼¼çš„é—®é¢˜å‘¢ï¼Ÿï¼ä»¥ä¸Šçš„çŸ¥è¯†ç‚¹ï¼Œå¾ˆç»†èŠ‚ï¼Œä½†æˆ‘è®¤ä¸ºä¹Ÿæ˜¯æŒºæœ‰ä»·å€¼çš„ã€‚

å½“ç„¶äº†ï¼Œä½ æ€ä¹ˆè¯´éƒ½è¡Œï¼Œä½ éƒ½æ˜¯å¯¹çš„ï¼Œä½ å¼€å¿ƒå°±å¥½ï¼

ç­”æ¡ˆæ¥è‡ªï¼š[https://polarisxu.studygolang.com/posts/go/action/interview-len-shift/](https://polarisxu.studygolang.com/posts/go/action/interview-len-shift/)

---

### 25 æ¥¼

len(s)

- è‹¥ s ä¸ºå­—ç¬¦ä¸²å¸¸é‡æˆ–è€…ç®€å•çš„æ•°ç»„è¡¨è¾¾å¼ï¼Œåˆ™ len è¿”å›çš„ä¸º int å‹çš„å¸¸é‡
- è‹¥ s ä¸ºä¸ä¸ºä¸Šè¿°æƒ…å†µï¼ˆæœ‰å‡½æ•°è®¡ç®—ã€é€šé“ç­‰ï¼‰ï¼Œåˆ™ len è¿”å›çš„ä¸º int å‹çš„å˜é‡

å…³äºä½ç§»æ“ä½œ

- å¦‚æœå¸¸é‡ä½ç§»è¡¨è¾¾å¼ çš„å·¦ä¾§æ“ä½œæ•°æ˜¯ä¸€ä¸ªæ— ç±»å‹å¸¸é‡ï¼Œé‚£ä¹ˆå…¶ç»“æœæ˜¯ä¸€ä¸ªæ•´æ•°å¸¸é‡ï¼›å¦åˆ™å°±æ˜¯å’Œå·¦ä¾§æ“ä½œæ•°åŒä¸€ç±»å‹çš„å¸¸é‡ï¼ˆå¿…é¡»æ˜¯ æ•´æ•°ç±»å‹ ï¼‰
- å¦‚æœä¸€ä¸ªéå¸¸é‡ä½ç§»è¡¨è¾¾å¼çš„å·¦ä¾§çš„æ“ä½œæ•°æ˜¯ä¸€ä¸ªæ— ç±»å‹å¸¸é‡ï¼Œé‚£ä¹ˆå®ƒä¼šå…ˆè¢«éšå¼åœ°è½¬æ¢ä¸ºå‡å¦‚ä½ç§»è¡¨è¾¾å¼è¢«å…¶å·¦ä¾§æ“ä½œæ•°å•ç‹¬æ›¿æ¢åçš„ç±»å‹

è§£é‡Šä¸€ä¸‹ï¼šâ€œå…ˆè¢«éšå¼åœ°è½¬æ¢ä¸ºå‡å¦‚ä½ç§»è¡¨è¾¾å¼è¢«å…¶å·¦ä¾§æ“ä½œæ•°å•ç‹¬æ›¿æ¢åçš„ç±»å‹"ï¼Œå¯¹äº var b byte = 1 << len(s[:])ï¼Œ1 << len(s[:])ä¼šè¢«éšå¼çš„è½¬æ¢ä¸º var b byte = 1(è¡¨è¾¾å¼è¢« 1 å•ç‹¬æ›¿æ¢)çš„ç±»å‹ï¼Œ1 ä¸ºæ— ç±»å‹å¸¸é‡ï¼Œå› ä¸º b ä¸º byteï¼Œæ‰€ä»¥ 1 ä¼šè¢«éšå¼è½¬æ¢ä¸º byteï¼Œæ‰€ä»¥ 1 << len(s[:])ä¸º byte ç±»å‹ã€‚

é¦–å…ˆï¼Œs ä¸ºå¸¸é‡è¡¨è¾¾å¼ã€‚

å¯¹äº var a byte = 1 << len(s) / 128ï¼Œlen(s)è¿”å›æ•´å‹å¸¸é‡ï¼Œæ‰€ä»¥ 1 << len(s)ä¸ºå¸¸é‡è¡¨è¾¾å¼ï¼Œä¸” 1 ä¸ºæ— ç±»å‹å¸¸é‡ï¼Œç¬¦åˆä½ç§»æ“ä½œçš„ç¬¬ä¸€ç§æƒ…å†µï¼Œæ‰€ä»¥ä¸ºè¡¨è¾¾å¼ç»“æœä¸ºæ•´å‹å¸¸é‡ï¼Œæ•…æœ€åè®¡ç®—ä¸º 4ï¼›

å¯¹äº var b byte = 1 << len(s[:]) / 128ï¼Œs[:]ä¸ºå‡½æ•°è®¡ç®—ï¼Œæ‰€ä»¥ len(s[:])è¿”å›çš„ä¸ºæ•´å‹å˜é‡ï¼Œæ‰€ä»¥ 1 << len(s[:]) / 128 ä¸ºéå¸¸é‡è¡¨è¾¾å¼ï¼Œä¸” 1 ä¸ºæ— ç±»å‹å¸¸é‡ï¼Œç¬¦åˆä½ç§»æ“ä½œçš„ç¬¬äºŒç§æƒ…å†µï¼Œæ‰€ä»¥ä¸ºè¡¨è¾¾å¼ç»“æœä¸º byteï¼Œ1<<9 ä¸º 512ï¼Œè½¬ä¸º byte ç±»å‹ï¼Œç»“æœæº¢å‡ºï¼Œä¸º 0ã€‚

</div>
</details>
